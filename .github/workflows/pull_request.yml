name: 'Pull Request'


on:
  pull_request:
    branches: [ develop, staging, master ]


jobs:
  check_skip_flags:
    name: Check skip flags
    runs-on: ubuntu-latest
    outputs:
      head-commit-message: ${{ steps.get_head_commit_message.outputs.headCommitMsg }}
    steps:
      - name: Get repo
        uses: actions/checkout@v3
        with:
          ref: ${{ github.event.pull_request.head.sha }}
      - name: Print head git commit message
        id: get_head_commit_message
        run: echo "::set-output name=headCommitMsg::$(git show -s --format=%s)"


  notify:
    runs-on: ubuntu-latest
    steps:
      - name: show commit messages in notification
        uses: neonidian/teams-notify-build-status@v3
        with:
          webhookUrl: | # Send to multiple channels in MS Teams
            https://uic365.webhook.office.com/webhookb2/e2758c1c-477f-4de7-b1bd-c8f35fe1d105@e202cd47-7a56-4baa-99e3-e3b71a7c77dd/IncomingWebhook/ef5cd950674649228b1ae1c203a82a2a/68f631fe-fabd-412d-b045-29ece196782a
          title: 'NULL' # Specify a title header
          titleBackgroundColor: ${{ steps.unitTest.outcome }} # Specify title background color. 'unitTest' is the ID of a step
          status: ${{ steps.unitTest.outcome }} # Specify what should be displayed in the status label
          message: "NULL"
        env: # Enable actor labels and buttons using environment variables
          SHOULD_DISPLAY_ACTOR_LABEL: false
          SHOULD_DISPLAY_VIEW_RUN_BUTTON: true
          SHOULD_DISPLAY_VIEW_COMMIT_BUTTON: true
